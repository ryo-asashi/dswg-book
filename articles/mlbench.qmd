---
title: "mlbench"
author: "データサイエンス関連基礎調査WG"
date: "`r Sys.Date()`"
#format: docx
format: html
lang: ja
output:
  word_document:
    toc: yes
    toc_depth: '3'
    fig_width: 6
    fig_height: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
if (!require(mlbench)) install.packages('mlbench', repos = "http://cran.us.r-project.org")
```

## パッケージの概要

mlbenchには、機械学習モデルの性能を比較・評価するベンチマーク課題用のデータセット、およびデータを生成するための関数が用意されています。

データセットは、例えばBostonHousing等の有名なデータセットや、UCIリポジトリ\[1\] (カリフォルニア大学アーバイン校が公開している機械学習データセットリポジトリ)の一部のデータセット等が含まれています。\
また、ベンチマーク課題用のテストデータを生成する関数には、例えば複数クラスの2次元正規分布を生成するmlbench.2dnormals関数や、螺旋データを生成するmlbench.spiral関数等、様々な種類の関数が用意されています。

なお、mlbenchに用意されているこれらのデータ生成用の関数は、mlbench.\[データを示す名称\]という形式の関数名になっています。一方、mlbenchに格納されているデータセットそのものは、BostonHousingやZooのように、mlbench.がついておらず大文字から始まる名称なので、データセットとデータ生成関数は名前で区別することができます。

## パッケージの使用例

### データセット

mlbenchには、様々なベンチマーク課題用のデータセットが用意されています。 データセットは以下のように、データセット名を指定してdata.frameとしてロードすることができます。

```{r}
library(mlbench)
data("BostonHousing", package = "mlbench")
str(BostonHousing)
```

以下は格納されているデータセットの一覧です。(バージョン2.1.5時点です。)\
クラス分類用のデータや回帰用のデータ、特徴量が連続変数のデータやカテゴリ変数のデータ、クラスに偏りがあるデータなど、様々な種類の機械学習のベンチマーク課題に使用できるようなデータが格納されています。 各データのカラムやデータソース等の詳細は、mlbenchのリファレンスをご参照ください。

| データセット名 | 概要 | 課題の種別 | レコード数 | カラム数 |
|:-----------|:----------------------|:-----------|-----------:|-----------:|
| BostonHousing | 1970年調査によるボストン506区画の住宅価格データ | 回帰 | 506 | 14 |
| BreastCancer | 乳がんの事例に関するデータから良性／悪性に分類 | 2クラス分類 | 699 | 11 |
| DNA | DNAのスプライス・ジャンクションの塩基配列データを、エクソン-イントロン／イントロン―エクソン／それ以外に分類 | 多クラス分類 | 3,186 | 181 |
| Glass | 7種類のガラスに対する化学分析のデータ | 多クラス分類 | 214 | 10 |
| HouseVotes84 | 1984年のアメリカ合衆国議会の16の投票記録から民主党／共和党を分類 | 2クラス分類 | 435 | 17 |
| Ionosphere | 電離層のレーダー・リターンデータをgood／badに分類 | 2クラス分類 | 351 | 35 |
| LetterRecognition | アルファベットの画像から計算された特徴量をもとにA-Zを分類 | 多クラス分類 | 20,000 | 17 |
| Ozone | 1976年のロサンゼルスのオゾン汚染データ | 回帰 | 366 | 13 |
| PimaIndiansDiabetes | ピマ・インディアン女性のデータから糖尿病発症あり／なしを分類 | 2クラス分類 | 768 | 9 |
| Satellite | ランドサット衛星の衛星画像データを土壌、植生等のクラスに分類 | 多クラス分類 | 6,435 | 37 |
| Servo | サーボシステムの応答時間の予測課題(ただし、mlbenchでは応答時間が順序尺度に変換されている) | 多クラス分類 | 167 | 5 |
| Shuttle | スペースシャトルの飛行中の状態を7種類に分類 | 多クラス分類 | 58,000 | 10 |
| Sonar | ソナー信号が岩石からの反射か、金属円筒からの反射かを識別 | 2クラス分類 | 208 | 61 |
| Soybean | 19クラスのダイズの病害を分類 | 多クラス分類 | 683 | 36 |
| Vehicle | 車のシルエットに関する特徴量から4車種に分類 | 多クラス分類 | 846 | 19 |
| Vowel | イギリス英語の11種類の母音を分類 | 多クラス分類 | 990 | 11 |
| Zoo | 毛の有無、羽の有無等、主に論理値の特徴量から動物の種類を分類 | 多クラス分類 | 101 | 17 |

: {#tbl-1}

### データ生成関数

mlbenchには前項で紹介したデータセットに加え、ベンチマーク課題用のデータを自ら生成するための関数も用意されています。

以下は、指定したクラス数のクラスごとに、2次元空間上で正規分布するデータを生成する、mlbench.2dnormalsの使用例です。 これらの生成関数によるデータは、R標準のS3 classという機能を用いて、as.data.frame関数とplot関数が適切に動作するように実装されています。 すなわち、List形式で返される生成データを引数として、as.data.frame関数によるデータフレームへ変換、およびplot関数による生成データの種類に応じたグラフのプロットができるようになっています。

```{r}
# 乱数シードの設定
set.seed(123)

# 2次元正規分布データの生成
## cl=2が2クラスを意味する
## デフォルトでは原点を中心に、半径r=(cl)^(1/2)の円上に各クラスの中心を配置する
p <- mlbench.2dnormals(n=1000, cl=2, sd=1)

# 生成したデータはmlbench.2dnormals classのList形式
str(p)

# data.frameへの変換
str(as.data.frame(p))

# mlbench.2dnormals classのplot
plot(p)
```

さらに、mlbenchの生成データに対して適用可能なベイズ識別器、bayesclass関数が用意されています。内部的には、引数として渡す生成データの種類によって、適切な識別関数の実装が呼び出されています。

以下は、mlbench.2dnormalsで生成した2クラス分類用のデータ対する、bayesclass関数による分類結果をプロットしています。 mlbench.2dnormalsの生成データの場合、いずれのクラスも同分散の2次元正規分布に従うため、個々のデータは、各クラスの正規分布の中心(期待値)のうち、最も距離の近い中心を持つクラスへと分類されることになります。 そのため、上のグラフで示した真のクラスと、下図の分類結果とを比較すると、グラフ中央付近の両クラスのデータが重なる領域では、誤分類が発生していることがわかります。

```{r}
plot(p$x, col=as.numeric(bayesclass(p)))
```

上で紹介したmlbench.2dnormals以外にも、mlbenchでは様々なデータ生成用の関数が用意されています。 以下ではいくつかの例をplotしています。 これらの例に挙げたもの以外を含む、関数の一覧や各関数の詳細については、mlbenchのリファレンスをご参照ください。

##### Spiral

```{r}
plot(mlbench.spirals(n=200, sd=0.05))
```

##### Circle

```{r}
plot(mlbench.circle(n=1000))
```

##### Shapes

```{r}
plot(mlbench.shapes(n=1000))
```

##### Smiley

```{r}
plot(mlbench.smiley(n=1000))
```

## 参考資料

\[1\] [UC Irvine Machine Learning Repository](https://archive.ics.uci.edu/).
