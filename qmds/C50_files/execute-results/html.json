{
  "hash": "43aa194ee3a2d8578064e13d36494d0e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"C50\"\nauthor: \"データサイエンス関連基礎調査WG\"\ndate: \"2025-01-16\"\noutput:   \n  word_document:\n    toc: yes\n    toc_depth: '3'\n    fig_width: 6\n    fig_height: 3\n---\n\n\n\n\n\n\n\n\n## パッケージの概要\n\nC50パッケージではC5.0アルゴリズムを用いた決定木モデルを使用できます。\n\n## 参考URL\n\n公式ドキュメント <https://cran.r-project.org/web/packages/C50/C50.pdf>\n\n## 使用例：irisデータの分類\n\nirisデータを用いて、がく弁・花弁の長さ・幅の情報からアヤメを分類するモデルをC50パッケージを用いて構築します。\n\n### irisデータセットを読み込む\n\nirisデータを読み込み、データの先頭を表示します。\n\n-   Sepal.Length：がく弁の長さ\n-   Sepal.Width：がく弁の幅\n-   Petal.Length：花弁の長さ\n-   Petal.Width：花弁の幅\n\nアヤメの種類はsetosa(1)、versicolor(2)、virginica(3)の3種類です。\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(iris)\nhead(iris)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n```\n\n\n:::\n:::\n\n\n\n\n\n\n### irisデータの構造\n\nirisデータの各種構造を確認します。\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(iris)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t150 obs. of  5 variables:\n $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...\n $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...\n $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...\n $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...\n $ Species     : Factor w/ 3 levels \"setosa\",\"versicolor\",..: 1 1 1 1 1 1 1 1 1 1 ...\n```\n\n\n:::\n:::\n\n\n\n\n\n\nまた、データを散布図にプロットして確認します。\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(iris, col=c(2, 3, 4)[iris$Species])\n```\n\n::: {.cell-output-display}\n![](C50_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n### モデル構築\n\nirisデータをモデル生成のための訓練データと、モデル評価のためのテストデータに分割します。データ割合は訓練データを7割、テストデータを3割とします。確認のため、データサイズを出力します。\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 再現性のためにシードを設定\nset.seed(123)\n\n# データの分割\nsample_indices <- sample(1:nrow(iris), 0.7 * nrow(iris))  \ntrain_data <- iris[sample_indices, ]\ntest_data <- iris[-sample_indices, ]\n\n# データサイズの確認\nc(nrow(iris), nrow(train_data), nrow(test_data))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 150 105  45\n```\n\n\n:::\n:::\n\n\n\n\n\n\nモデルを生成します。\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- C5.0(\n  x = train_data[-5], \n  y = train_data$Species, \n)\n```\n:::\n\n\n\n\n\n\nモデルのサマリを表示します。\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nC5.0.default(x = train_data[-5], y = train_data$Species)\n\n\nC5.0 [Release 2.07 GPL Edition]  \tThu Jan 16 18:17:54 2025\n-------------------------------\n\nClass specified by attribute `outcome'\n\nRead 105 cases (5 attributes) from undefined.data\n\nDecision tree:\n\nPetal.Length <= 1.9: setosa (36)\nPetal.Length > 1.9:\n:...Petal.Width > 1.7: virginica (34/1)\n    Petal.Width <= 1.7:\n    :...Petal.Length <= 4.9: versicolor (31/1)\n        Petal.Length > 4.9: virginica (4/1)\n\n\nEvaluation on training data (105 cases):\n\n\t    Decision Tree   \n\t  ----------------  \n\t  Size      Errors  \n\n\t     4    3( 2.9%)   <<\n\n\n\t   (a)   (b)   (c)    <-classified as\n\t  ----  ----  ----\n\t    36                (a): class setosa\n\t          30     2    (b): class versicolor\n\t           1    36    (c): class virginica\n\n\n\tAttribute usage:\n\n\t100.00%\tPetal.Length\n\t 65.71%\tPetal.Width\n\n\nTime: 0.0 secs\n```\n\n\n:::\n:::\n\n\n\n\n\n\nplot関数を用いると、決定木の様子が可視化されます。\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(model)\n```\n\n::: {.cell-output-display}\n![](C50_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n構築したモデルを使用して予測を行います。\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- predict(model, test_data[-5])\n```\n:::\n\n\n\n\n\n\n結果を確認します。予測が概ねあっていることが分かります。\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(table(res, test_data$Species))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            \nres          setosa versicolor virginica\n  setosa         14          0         0\n  versicolor      0         17         0\n  virginica       0          1        13\n```\n\n\n:::\n:::\n",
    "supporting": [
      "C50_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}